import{DefaultNamingStrategy as P}from"typeorm";var D=63,Y=2147483647,y=-2147483648,T=32767,C=-32768,tt="9223372036854775807",rt="-9223372036854775808",et="3141592653589793238462643383279502.1618033988749894848204586834365638",nt="-3141592653589793238462643383279502.1618033988749894848204586834365638",it=254,st=6,ot=99,at=1,ct=128,gt=5,ft={comment:"Extra data in JSON format",default:{},name:"extra",nullable:!1,type:"json"},k;(function(g){g.BigInteger="bigint",g.Decimal="decimal",g.Integer="integer",g.SmallInteger="smallint",g.UUID="uuid"})(k||(k={}));var U;(function(t){t.BigInteger="bigint",t.Bit="bit",t.BitVarying="bit varying",t.Bool="bool",t.Boolean="boolean",t.Box="box",t.ByteHexadecimal="bytea",t.CIText="citext",t.Char="char",t.Character="character",t.CharacterVarying="character varying",t.Circle="circle",t.Cube="cube",t.Date="date",t.DateRange="daterange",t.Decimal="decimal",t.DoublePrecision="double precision",t.Enum="enum",t.Float="float",t.Float4="float4",t.Float8="float8",t.Geography="geography",t.Geometry="geometry",t.HStore="hstore",t.IPAddress="inet",t.IPCIDR="cidr",t.Int="int",t.Int2="int2",t.Int4="int4",t.Int4Range="int4range",t.Int8="int8",t.Int8Range="int8range",t.Integer="integer",t.Interval="interval",t.JSON="json",t.JSONB="jsonb",t.LabelTrees="ltree",t.Line="line",t.LineSegment="lseg",t.MACAddress="macaddr",t.Money="money",t.NumberRange="numrange",t.Numeric="numeric",t.Path="path",t.Point="point",t.Polygon="polygon",t.Real="real",t.SmallInteger="smallint",t.String="character varying",t.Text="text",t.TextSearchQuery="tsquery",t.TextSearchVector="tsvector",t.Time="time",t.TimeStamp="timestamp",t.TimeStampWithTimeZoneAbbr="timestamptz",t.TimeStampWithTimeZoneRange="tstzrange",t.TimeStampWithoutTimeZone="timestamp without time zone",t.TimeStampWithoutTimeZoneRange="tsrange",t.TimeWithTimeZoneAbbr="timetz",t.TimeWithTimeZone="time with time zone",t.TimeWithoutTimeZone="time without time zone",t.TimeStampWithTimeZone="timestamp with time zone",t.UUID="uuid",t.VariableBitString="varbit",t.VariableChar="varchar",t.XML="xml"})(U||(U={}));var m;(function(c){c[c.EmailMax=254]="EmailMax",c[c.EmailMin=6]="EmailMin",c[c.NameMax=99]="NameMax",c[c.NameMin=1]="NameMin",c[c.PassMax=128]="PassMax",c[c.PassMin=5]="PassMin"})(m||(m={}));var A;(function(s){s.AltKey="ak",s.Check="ck",s.Default="df",s.Exclusion="ex",s.ForeignKey="fk",s.Index="idx",s.PrimaryKey="pk",s.Relation="rel",s.Sequences="seq",s.Unique="uq"})(A||(A={}));var M;(function(s){s.AltKey="AK",s.Check="CK",s.Default="DF",s.Exclusion="EX",s.ForeignKey="FK",s.Index="IDX",s.PrimaryKey="PK",s.Relation="REL",s.Sequences="SEQ",s.Unique="UQ"})(M||(M={}));function X(r){let i=Array(r.length>>2);for(let e=0;e<i.length;e+=1)i[e]=0;for(let e=0;e<r.length*8;e+=8)i[e>>5]|=(r.charCodeAt(e/8)&255)<<24-e%32;return i}function B(r){let i="";for(let e=0;e<r.length*32;e+=8)i+=String.fromCharCode(r[e>>5]>>>24-e%32&255);return i}function Q(r,i){r[i>>5]|=128<<24-i%32,r[(i+64>>9<<4)+15]=i;let e=Array(80),n=1732584193,o=-271733879,g=-1732584194,c=271733878,f=-1009589776;for(let a=0;a<r.length;a+=16){let d=n,s=o,l=g,I=c,$=f;for(let h=0;h<80;h+=1){h<16?e[h]=r[a+h]:e[h]=S(e[h-3]^e[h-8]^e[h-14]^e[h-16],1);let F=b(b(S(n,5),v(h,o,g,c)),b(b(f,e[h]),H(h)));f=c,c=g,g=S(o,30),o=n,n=F}n=b(n,d),o=b(o,s),g=b(g,l),c=b(c,I),f=b(f,$)}return Array(n,o,g,c,f)}function v(r,i,e,n){return r<20?i&e|~i&n:r<40?i^e^n:r<60?i&e|i&n|e&n:i^e^n}function H(r){return r<40?r<20?1518500249:1859775393:r<60?r<20?1518500249:-1894007588:r<20?1518500249:-899497514}function b(r,i){let e=(r&65535)+(i&65535);return(r>>16)+(i>>16)+(e>>16)<<16|e&65535}function S(r,i){return r<<i|r>>>32-i}function z(r){let i="",e=-1,n,o;for(;++e<r.length;)n=r.charCodeAt(e),o=e+1<r.length?r.charCodeAt(e+1):0,55296<=n&&n<=56319&&56320<=o&&o<=57343&&(n=65536+((n&1023)<<10)+(o&1023),e+=1),n<=127?i+=String.fromCharCode(n):n<=2047?i+=String.fromCharCode(192|n>>>6&31,128|n&63):n<=65535?i+=String.fromCharCode(224|n>>>12&15,128|n>>>6&63,128|n&63):n<=2097151&&(i+=String.fromCharCode(240|n>>>18&7,128|n>>>12&63,128|n>>>6&63,128|n&63));return i}function Z(r){return B(Q(X(r),r.length*8))}function j(r){let i="",e;for(let n=0;n<r.length;n+=1)e=r.charCodeAt(n),i+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(e&15);return i}function u(r){return j(Z(z(r)))}function E(r){return typeof r=="string"?r:typeof r=="object"&&"name"in r&&typeof r.name=="string"&&r.name.length>0?r.name:String(r)}function R(r,i=!1){return r.replace(/^([A-Z])|[\s-_](\w)/g,function(e,n,o,g){return i&&g===0?n:o?o.toUpperCase():n.toLowerCase()})}function G(r){return r.replace(/(?:([a-z])([A-Z]))|(?:((?!^)[A-Z])([a-z]))/g,"$1_$3$2$4").toLowerCase()}var N=64;function _(r,i="_",e="__"){if(r.length<N){let a=r.trim().split(e),l=a.pop().split(i).map(G),$=`${a.join(e)}${e}${l.join(i)}`;return $.length<N?$:r}let n=r.trim().split(e),o=[...n].pop(),c=o.split(i).map(G).map(a=>a.endsWith("_id")||a.endsWith("_ref")?a.substring(0,a.length-3):a.endsWith("_uuid")?a.substring(0,a.length-5):a),f=n.join(e);{let a=`${f}${c.join(i)}`;if(a.length<N)return a}{let a=`${f}${c.map(d=>R(d)).join(i)}`;if(a.length<N)return a}{let a=`${f}${c.map(d=>R(d)).join(i)}`;if(a.length<N)return a}{let a=`${f}${u(o)}`;if(a.length<N)return a}{let a=n.shift(),d=n.join(e)+o,s=`${a}${e}${u(d)}`;if(s.length<N)return s}return u(r)}function L(r,i=!0){let e=r.trim().normalize("NFC");if(!e.includes("."))return e;if(i&&e.startsWith("public."))return e.substr(7);let n=e.split(".");return n.length!==2?e:n[1]}function x(r,i=!0){let e=r.trim().normalize("NFC");return i?L(r,!0):e}var J=class extends P{constructor(){super(...arguments);this.name="SafeNamingStrategy"}indexName(i,e,n,o="IDX",g=!0,c=!0){let f=x(E(i),g),a=D-o.length,d=e.map(l=>x(l,g)).join("_"),s=`${o}__${f}__${d}`;if(s.length>a){if(c){let l=`${o}__${d}`;if(l.length<=a)return _(l)}return _(`${o}__${u(s)}`)}else return _(s)}foreignKeyName(i,e,n,o,g="FK",c=!0,f=!0){let a=x(E(i),c),d=x(n||"",c),s=e.reduce((I,$)=>`${x(I,c)}__${x($,c)}`,`${a}__${d}`),l=D-g.length+2;if(s.length>l){if(f){let I=e.reduce(($,h)=>`_${x(h,c)}`,"");if(I.length<=l)return _(`${g}_${I}`)}return _(`${g}__${u(s)}`)}else return _(`${g}__${s}`)}primaryKeyName(i,e,n="PK",o=!0,g=!0){let c=x(E(i),o),f=D-n.length,a=e.map(s=>x(s,o)).join("_"),d=`${n}__${c}__${a}`;if(d.length>f){if(g){let s=`${n}__${a}`;if(s.length<=f)return _(s)}return _(`${n}__${u(d)}`)}else return _(d)}relationConstraintName(i,e,n="REL",o=!0,g=!0){let c=x(E(i),o),f=D-n.length,a=e.map(s=>x(s,o)).join("_"),d=`${n}__${c}__${a}`;if(d.length>f){if(g){let s=`${n}__${a}`;if(s.length<=f)return _(s)}return _(`${n}__${u(d)}`)}else return _(d)}};var qt={eager:!0},wt={eager:!0,onDelete:"RESTRICT",onUpdate:"CASCADE"},Kt={eager:!0,onDelete:"CASCADE",onUpdate:"CASCADE"};import{getMetadataArgsStorage as O}from"typeorm";function V(r){return r.map(i=>{i=i.trim();do i=i.trim().substring(0,i.length-1);while(i.endsWith(";"));return i}).join(" AND ")}function W(r,i){let e,n;if(typeof r=="string"||r instanceof String?i?(e=r,n=i):n=r:Array.isArray(r)?n=r:typeof r=="object"&&("name"in r&&(e=r.name),"expressions"in r&&(n=r.expressions)),!n||n.length===0)throw new Error(`Check expressions is required \u279C ${JSON.stringify(r)}, ${JSON.stringify(i)}`);return Array.isArray(n)||(n=[n]),n=V(n),{checkName:e,expressions:n}}function Xt(r,i){let{checkName:e,expressions:n}=W(r,i);return function(g,c){O().checks.push({target:c?g.constructor:g,name:e,expression:n})}}import{Index as w}from"typeorm";function q(r,i="IDX",e="_",n="__"){return _(`${i}${n}${r.join(e)}`,e,n)}function Pt(r,i=!1,e=!1){if(Array.isArray(r)){let n=r,o;return e===!0?o=A.Index:typeof e=="string"&&(o=e),w(q(n,o),n)}else{let n=i,o=r;return e===!0?o=`${A.Index}__${o}`:typeof e=="string"&&(o=`${e}${o}`),w(_(o),n)}}import{Unique as p}from"typeorm";function K(r,i="UQ",e="_",n="__"){return _(`${i}${n}${r.join(e)}`,e,n)}function Ct(r,i=!1,e=!1){if(Array.isArray(r)){let n=r,o;return e===!0?o=A.Unique:typeof e=="string"&&(o=e),p(K(n,o),n)}else{let n=i,o=r;return e===!0?o=`${A.Unique}__${o}`:typeof e=="string"&&(o=`${e}${o}`),p(_(o),n)}}export{Xt as Checks,ft as ColumnOptionsExtra,A as ColumnPrefix,k as ColumnPrimaryType,M as ColumnSuffix,U as ColumnType,m as ConstLength,it as EMAIL_LENGTH_MAX,st as EMAIL_LENGTH_MIN,Pt as IndexColumns,qt as MANY_TO_MANY_OPTION_DEFAULT,wt as MANY_TO_ONE_OPTION_DEFAULT,ot as NAME_LENGTH_MAX,at as NAME_LENGTH_MIN,Kt as ONE_TO_ONE_OPTION_DEFAULT,ct as PASSWORD_LENGTH_MAX,gt as PASSWORD_LENGTH_MIN,tt as PGSQL_BIG_INTEGER_MAX,rt as PGSQL_BIG_INTEGER_MIN,Y as PGSQL_INTEGER_MAX,y as PGSQL_INTEGER_MIN,D as PGSQL_MAX_IDENTIFIER_LENGTH,et as PGSQL_NUMERIC_MAX,nt as PGSQL_NUMERIC_MIN,T as PGSQL_SMALL_INTEGER_MAX,C as PGSQL_SMALL_INTEGER_MIN,J as SafeNamingStrategy,Ct as UniqueColumns,u as cryptSha1,E as extractTableName,_ as safeConstraint,q as safeIndex,K as safeUnique,x as stripPublic,L as stripSchema};
