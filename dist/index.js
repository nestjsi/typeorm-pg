var Z=Object.create;var S=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,O=Object.prototype.hasOwnProperty;var B=r=>S(r,"__esModule",{value:!0});var V=(r,i)=>{B(r);for(var e in i)S(r,e,{get:i[e],enumerable:!0})},W=(r,i,e)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of P(i))!O.call(r,n)&&n!=="default"&&S(r,n,{get:()=>i[n],enumerable:!(e=j(i,n))||e.enumerable});return r},R=r=>W(B(S(r!=null?Z(J(r)):{},"default",r&&r.__esModule&&"default"in r?{get:()=>r.default,enumerable:!0}:{value:r,enumerable:!0})),r);V(exports,{Checks:()=>St,ColumnOptionsExtra:()=>ft,ColumnPrefix:()=>u,ColumnPrimaryType:()=>G,ColumnSuffix:()=>m,ColumnType:()=>k,ConstLength:()=>U,EMAIL_LENGTH_MAX:()=>it,EMAIL_LENGTH_MIN:()=>st,IndexColumns:()=>Rt,MANY_TO_MANY_OPTION_DEFAULT:()=>It,MANY_TO_ONE_OPTION_DEFAULT:()=>$t,NAME_LENGTH_MAX:()=>ot,NAME_LENGTH_MIN:()=>at,ONE_TO_ONE_OPTION_DEFAULT:()=>Nt,PASSWORD_LENGTH_MAX:()=>ct,PASSWORD_LENGTH_MIN:()=>gt,PGSQL_BIG_INTEGER_MAX:()=>tt,PGSQL_BIG_INTEGER_MIN:()=>rt,PGSQL_INTEGER_MAX:()=>Y,PGSQL_INTEGER_MIN:()=>y,PGSQL_MAX_IDENTIFIER_LENGTH:()=>D,PGSQL_NUMERIC_MAX:()=>et,PGSQL_NUMERIC_MIN:()=>nt,PGSQL_SMALL_INTEGER_MAX:()=>T,PGSQL_SMALL_INTEGER_MIN:()=>C,SafeNamingStrategy:()=>v,UniqueColumns:()=>Gt,cryptSha1:()=>b,extractTableName:()=>E,safeConstraint:()=>f,safeIndex:()=>K,safeUnique:()=>F,stripPublic:()=>x,stripSchema:()=>w});var Q=R(require("typeorm"));var D=63,Y=2147483647,y=-2147483648,T=32767,C=-32768,tt="9223372036854775807",rt="-9223372036854775808",et="3141592653589793238462643383279502.1618033988749894848204586834365638",nt="-3141592653589793238462643383279502.1618033988749894848204586834365638",it=254,st=6,ot=99,at=1,ct=128,gt=5,ft={comment:"Extra data in JSON format",default:{},name:"extra",nullable:!1,type:"json"},G;(function(g){g.BigInteger="bigint",g.Decimal="decimal",g.Integer="integer",g.SmallInteger="smallint",g.UUID="uuid"})(G||(G={}));var k;(function(t){t.BigInteger="bigint",t.Bit="bit",t.BitVarying="bit varying",t.Bool="bool",t.Boolean="boolean",t.Box="box",t.ByteHexadecimal="bytea",t.CIText="citext",t.Char="char",t.Character="character",t.CharacterVarying="character varying",t.Circle="circle",t.Cube="cube",t.Date="date",t.DateRange="daterange",t.Decimal="decimal",t.DoublePrecision="double precision",t.Enum="enum",t.Float="float",t.Float4="float4",t.Float8="float8",t.Geography="geography",t.Geometry="geometry",t.HStore="hstore",t.IPAddress="inet",t.IPCIDR="cidr",t.Int="int",t.Int2="int2",t.Int4="int4",t.Int4Range="int4range",t.Int8="int8",t.Int8Range="int8range",t.Integer="integer",t.Interval="interval",t.JSON="json",t.JSONB="jsonb",t.LabelTrees="ltree",t.Line="line",t.LineSegment="lseg",t.MACAddress="macaddr",t.Money="money",t.NumberRange="numrange",t.Numeric="numeric",t.Path="path",t.Point="point",t.Polygon="polygon",t.Real="real",t.SmallInteger="smallint",t.String="character varying",t.Text="text",t.TextSearchQuery="tsquery",t.TextSearchVector="tsvector",t.Time="time",t.TimeStamp="timestamp",t.TimeStampWithTimeZoneAbbr="timestamptz",t.TimeStampWithTimeZoneRange="tstzrange",t.TimeStampWithoutTimeZone="timestamp without time zone",t.TimeStampWithoutTimeZoneRange="tsrange",t.TimeWithTimeZoneAbbr="timetz",t.TimeWithTimeZone="time with time zone",t.TimeWithoutTimeZone="time without time zone",t.TimeStampWithTimeZone="timestamp with time zone",t.UUID="uuid",t.VariableBitString="varbit",t.VariableChar="varchar",t.XML="xml"})(k||(k={}));var U;(function(c){c[c.EmailMax=254]="EmailMax",c[c.EmailMin=6]="EmailMin",c[c.NameMax=99]="NameMax",c[c.NameMin=1]="NameMin",c[c.PassMax=128]="PassMax",c[c.PassMin=5]="PassMin"})(U||(U={}));var u;(function(s){s.AltKey="ak",s.Check="ck",s.Default="df",s.Exclusion="ex",s.ForeignKey="fk",s.Index="idx",s.PrimaryKey="pk",s.Relation="rel",s.Sequences="seq",s.Unique="uq"})(u||(u={}));var m;(function(s){s.AltKey="AK",s.Check="CK",s.Default="DF",s.Exclusion="EX",s.ForeignKey="FK",s.Index="IDX",s.PrimaryKey="PK",s.Relation="REL",s.Sequences="SEQ",s.Unique="UQ"})(m||(m={}));function dt(r){let i=Array(r.length>>2);for(let e=0;e<i.length;e+=1)i[e]=0;for(let e=0;e<r.length*8;e+=8)i[e>>5]|=(r.charCodeAt(e/8)&255)<<24-e%32;return i}function _t(r){let i="";for(let e=0;e<r.length*32;e+=8)i+=String.fromCharCode(r[e>>5]>>>24-e%32&255);return i}function ht(r,i){r[i>>5]|=128<<24-i%32,r[(i+64>>9<<4)+15]=i;let e=Array(80),n=1732584193,o=-271733879,g=-1732584194,c=271733878,d=-1009589776;for(let a=0;a<r.length;a+=16){let _=n,s=o,l=g,I=c,$=d;for(let h=0;h<80;h+=1){h<16?e[h]=r[a+h]:e[h]=M(e[h-3]^e[h-8]^e[h-14]^e[h-16],1);let z=A(A(M(n,5),xt(h,o,g,c)),A(A(d,e[h]),lt(h)));d=c,c=g,g=M(o,30),o=n,n=z}n=A(n,_),o=A(o,s),g=A(g,l),c=A(c,I),d=A(d,$)}return Array(n,o,g,c,d)}function xt(r,i,e,n){return r<20?i&e|~i&n:r<40?i^e^n:r<60?i&e|i&n|e&n:i^e^n}function lt(r){return r<40?r<20?1518500249:1859775393:r<60?r<20?1518500249:-1894007588:r<20?1518500249:-899497514}function A(r,i){let e=(r&65535)+(i&65535);return(r>>16)+(i>>16)+(e>>16)<<16|e&65535}function M(r,i){return r<<i|r>>>32-i}function bt(r){let i="",e=-1,n,o;for(;++e<r.length;)n=r.charCodeAt(e),o=e+1<r.length?r.charCodeAt(e+1):0,55296<=n&&n<=56319&&56320<=o&&o<=57343&&(n=65536+((n&1023)<<10)+(o&1023),e+=1),n<=127?i+=String.fromCharCode(n):n<=2047?i+=String.fromCharCode(192|n>>>6&31,128|n&63):n<=65535?i+=String.fromCharCode(224|n>>>12&15,128|n>>>6&63,128|n&63):n<=2097151&&(i+=String.fromCharCode(240|n>>>18&7,128|n>>>12&63,128|n>>>6&63,128|n&63));return i}function ut(r){return _t(ht(dt(r),r.length*8))}function At(r){let i="",e;for(let n=0;n<r.length;n+=1)e=r.charCodeAt(n),i+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(e&15);return i}function b(r){return At(ut(bt(r)))}function E(r){return typeof r=="string"?r:typeof r=="object"&&"name"in r&&typeof r.name=="string"&&r.name.length>0?r.name:String(r)}function L(r,i=!1){return r.replace(/^([A-Z])|[\s-_](\w)/g,function(e,n,o,g){return i&&g===0?n:o?o.toUpperCase():n.toLowerCase()})}function q(r){return r.replace(/(?:([a-z])([A-Z]))|(?:((?!^)[A-Z])([a-z]))/g,"$1_$3$2$4").toLowerCase()}var N=64;function f(r,i="_",e="__"){if(r.length<N){let a=r.trim().split(e),l=a.pop().split(i).map(q),$=`${a.join(e)}${e}${l.join(i)}`;return $.length<N?$:r}let n=r.trim().split(e),o=[...n].pop(),c=o.split(i).map(q).map(a=>a.endsWith("_id")||a.endsWith("_ref")?a.substring(0,a.length-3):a.endsWith("_uuid")?a.substring(0,a.length-5):a),d=n.join(e);{let a=`${d}${c.join(i)}`;if(a.length<N)return a}{let a=`${d}${c.map(_=>L(_)).join(i)}`;if(a.length<N)return a}{let a=`${d}${c.map(_=>L(_)).join(i)}`;if(a.length<N)return a}{let a=`${d}${b(o)}`;if(a.length<N)return a}{let a=n.shift(),_=n.join(e)+o,s=`${a}${e}${b(_)}`;if(s.length<N)return s}return b(r)}function w(r,i=!0){let e=r.trim().normalize("NFC");if(!e.includes("."))return e;if(i&&e.startsWith("public."))return e.substr(7);let n=e.split(".");return n.length!==2?e:n[1]}function x(r,i=!0){let e=r.trim().normalize("NFC");return i?w(r,!0):e}var v=class extends Q.DefaultNamingStrategy{constructor(){super(...arguments);this.name="SafeNamingStrategy"}indexName(i,e,n,o="IDX",g=!0,c=!0){let d=x(E(i),g),a=D-o.length,_=e.map(l=>x(l,g)).join("_"),s=`${o}__${d}__${_}`;if(s.length>a){if(c){let l=`${o}__${_}`;if(l.length<=a)return f(l)}return f(`${o}__${b(s)}`)}else return f(s)}foreignKeyName(i,e,n,o,g="FK",c=!0,d=!0){let a=x(E(i),c),_=x(n||"",c),s=e.reduce((I,$)=>`${x(I,c)}__${x($,c)}`,`${a}__${_}`),l=D-g.length+2;if(s.length>l){if(d){let I=e.reduce(($,h)=>`_${x(h,c)}`,"");if(I.length<=l)return f(`${g}_${I}`)}return f(`${g}__${b(s)}`)}else return f(`${g}__${s}`)}primaryKeyName(i,e,n="PK",o=!0,g=!0){let c=x(E(i),o),d=D-n.length,a=e.map(s=>x(s,o)).join("_"),_=`${n}__${c}__${a}`;if(_.length>d){if(g){let s=`${n}__${a}`;if(s.length<=d)return f(s)}return f(`${n}__${b(_)}`)}else return f(_)}relationConstraintName(i,e,n="REL",o=!0,g=!0){let c=x(E(i),o),d=D-n.length,a=e.map(s=>x(s,o)).join("_"),_=`${n}__${c}__${a}`;if(_.length>d){if(g){let s=`${n}__${a}`;if(s.length<=d)return f(s)}return f(`${n}__${b(_)}`)}else return f(_)}};var It={eager:!0},$t={eager:!0,onDelete:"RESTRICT",onUpdate:"CASCADE"},Nt={eager:!0,onDelete:"CASCADE",onUpdate:"CASCADE"};var H=R(require("typeorm"));function Dt(r){return r.map(i=>{i=i.trim();do i=i.trim().substring(0,i.length-1);while(i.endsWith(";"));return i}).join(" AND ")}function Et(r,i){let e,n;if(typeof r=="string"||r instanceof String?i?(e=r,n=i):n=r:Array.isArray(r)?n=r:typeof r=="object"&&("name"in r&&(e=r.name),"expressions"in r&&(n=r.expressions)),!n||n.length===0)throw new Error(`Check expressions is required \u279C ${JSON.stringify(r)}, ${JSON.stringify(i)}`);return Array.isArray(n)||(n=[n]),n=Dt(n),{checkName:e,expressions:n}}function St(r,i){let{checkName:e,expressions:n}=Et(r,i);return function(g,c){(0,H.getMetadataArgsStorage)().checks.push({target:c?g.constructor:g,name:e,expression:n})}}var p=R(require("typeorm"));function K(r,i="IDX",e="_",n="__"){return f(`${i}${n}${r.join(e)}`,e,n)}function Rt(r,i=!1,e=!1){if(Array.isArray(r)){let n=r,o;return e===!0?o=u.Index:typeof e=="string"&&(o=e),(0,p.Index)(K(n,o),n)}else{let n=i,o=r;return e===!0?o=`${u.Index}__${o}`:typeof e=="string"&&(o=`${e}${o}`),(0,p.Index)(f(o),n)}}var X=R(require("typeorm"));function F(r,i="UQ",e="_",n="__"){return f(`${i}${n}${r.join(e)}`,e,n)}function Gt(r,i=!1,e=!1){if(Array.isArray(r)){let n=r,o;return e===!0?o=u.Unique:typeof e=="string"&&(o=e),(0,X.Unique)(F(n,o),n)}else{let n=i,o=r;return e===!0?o=`${u.Unique}__${o}`:typeof e=="string"&&(o=`${e}${o}`),(0,X.Unique)(f(o),n)}}
